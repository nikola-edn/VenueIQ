# Story 1.4: Bilingual Localization & Switcher

## Status
Ready for Dev

## Story
**As a** bilingual VenueIQ user,
**I want** the application UI to support Serbian Latin by default with an English toggle,
**so that** I can operate the app in my preferred language and share outputs with diverse stakeholders.

## Acceptance Criteria
1. All user-facing strings (labels, buttons, validation, toasts, export text) shall be sourced from RESX files with Serbian Latin (`AppResources.sr-Latn.resx`) as default and English (`AppResources.resx`) equivalent entries.
2. The Settings screen must provide a language toggle control that updates the UI language at runtime without requiring restart.
3. On first launch, the app shall default to Serbian Latin unless a stored preference exists; subsequent launches must respect the persisted language (depends on Story 1.3 persistence).
4. Language changes must propagate to the Main screen, Startup screen, Advanced Weights labels, export dialogs, and error states immediately.
5. Localization must extend to toast/alert messaging and accessibility descriptions (e.g., `SemanticProperties.Description`).
6. Automated tests validate resource presence, toggle behaviour, and fallbacks (missing string should log warning and display Serbian default).
7. All localized copy must follow the tone/terminology defined in `docs/front-end-spec.md#9-localization-guidelines`, including short/long variants for tooltips, badges, and toast messaging.
8. Language switching must provide user feedback (toast + screen reader announcement) confirming the active language and maintain focus context across pages.

## Tasks / Subtasks
- [ ] Build localization resource files (AC: 1,5)
  - [ ] Populate `AppResources.resx` (English) and `AppResources.sr-Latn.resx` (Serbian Latin) with keys for all current UI strings (AC: 1)
  - [ ] Ensure export templates and validation messages have localized entries (AC: 1,5)
  - [ ] Include UX-provided microcopy variants (tooltips, banners, toasts) and maintain glossary alignment (AC: 7)
- [ ] Implement runtime language switching (AC: 2-4)
  - [ ] Enhance `LocalizationService` to broadcast culture changes via messenger pattern (AC: 2,4)
  - [ ] Update `SettingsViewModel` toggle to invoke service and persist preference (AC: 2-3)
  - [ ] Trigger toast + `SemanticScreenReader.Announce` when language changes, using localized message (AC: 8)
- [ ] Update UI bindings (AC: 1,4,5)
  - [ ] Replace hard-coded strings with `{x:Static}` or dynamic localization bindings (AC: 1,4,5)
  - [ ] Ensure accessibility text pulls from resources (AC: 5)
- [ ] Testing (AC: 6)
  - [ ] Unit tests for `LocalizationService` verifying culture set + notification (AC: 6)
  - [ ] UI test toggling language and asserting updated text on key elements (AC: 2,4)
  - [ ] Static analysis ensuring no residual hard-coded strings (AC: 1)

## Dev Notes
- Align with localization approach described in `docs/ui-architecture.md` (sections 8 & 9) and maintain resource structure from `docs/architecture/9-source-tree.md`.
- Use `CommunityToolkit.Mvvm` `ObservableObject` to notify UI on resource change; consider `LocalizationResourceManager` pattern for runtime updates.
- Provide helper for toasts/snackbars retrieving localized messages to avoid duplication.
- Coordinate with Story 1.3 so language preference persistsâ€”ensure toggle triggers persistence while avoiding cyclic reload loops.
- When binding to accessibility descriptions, ensure they update on language change; consider `Effect` or behavior to refresh Semantic properties.
- Collaborate with design copy deck (appendix in `docs/front-end-spec.md`) to keep translations consistent; attach TODO markers for phrases pending final translation review.
- Verify that map legend, badge icons, and export PDF templates display language-neutral imagery or load localized assets when required.
- Update UX documentation to reflect any new string keys, keeping naming consistent (`Startup_Error_InvalidKey`, `Weights_ResetToast`, etc.).

### Testing
- Follow test strategy in `docs/architecture/13-test-strategy.md`; focus on ViewModel and UI automation layers.
- Implement unit tests using culture injection to confirm fallback to Serbian key when translation missing.
- UI test should toggle to English, verify sample controls update, toggle back to Serbian verifying persistence across navigation.
- Add lint step (e.g., custom analyzer or script) to detect hard-coded strings if feasible; manual checklist otherwise.
- Conduct localization QA sweep (manual or automated) to verify string lengths do not truncate layouts, toasts display for 3 seconds, and focus context remains after announcements (AC: 7-8).

## Change Log
| Date | Version | Description | Author |
|---|---|---|---|
| 2025-10-07 | 0.1 | Initial draft | Sarah (PO) |

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results
