# Story 2.5: Ranked Results List with Explainable Rationale

## Status
Ready for Dev

## Story
**As a** VenueIQ analyst,
**I want** a ranked list of suggested locations with transparent rationale,
**so that** I can compare options, understand why they score well, and present findings to stakeholders.

## Acceptance Criteria
1. MainViewModel shall transform `CellScore` data into a sorted `ObservableCollection<ResultItem>` limited to top N (default 10) entries, including score, CI/CoI/AI/DI breakdown, and top factors text.
2. Each result list item must display rank, total score, badges highlighting dominant factors (competition, demand, accessibility, complements), and a concise rationale snippet.
3. Selecting a list item recenters the map via MapWebView bridge, highlights the corresponding cell/pin, and expands a detail panel showing nearby POIs (competitors/complements) with distances.
4. Provide localization-ready text for badges and rationale; ensure dual-language content is supported (Serbian default, English toggle).
5. Handle empty/low result sets gracefully with explanatory UI (e.g., "Expand radius" suggestion) and ensure stale entries are cleared when analyses rerun.
6. Tests: unit tests for sorting/filtering logic and badge assignment, integration/UI tests covering selection synchronization with map and rationale display, snapshot tests verifying list template data bindings.
7. Ensure list interactions meet accessibility + UX standards: keyboard navigation (up/down), focus retention after refresh, `AutomationId` per item (`Results.Item.{rank}`), and `SemanticProperties.Description` summarizing rationale.
8. Detail pane must follow the accordion layout in `docs/front-end-spec.md#65-rationale-detail-pane`, including bilingual headings, POI chips with distance badges, and export-ready structured data.
9. Provide subtle list animations/transitions (e.g., fade/slide) consistent with UX motion guidance while maintaining 16ms frame budget on target devices.

## Tasks / Subtasks
- [ ] Data projection (AC: 1)
  - [ ] Convert `CellScore` to `ResultItem` including top POIs (AC: 1)
  - [ ] Limit collection to top N and expose pagination if needed (AC: 1)
- [ ] UI templates & bindings (AC: 2,4-5)
  - [ ] Build XAML `DataTemplate` for results list with rank, score pill, badges, rationale (AC: 2)
  - [ ] Localize labels/tooltips via resource keys (AC: 4)
  - [ ] Implement empty state view (AC: 5)
- [ ] Interaction wiring (AC: 3)
  - [ ] On selection, invoke MapWebView focus + highlight method (AC: 3)
  - [ ] Expand detail pane showing POI lists with distance heuristics (AC: 3)
  - [ ] Maintain focus order and restore previous selection after refresh (AC: 7)
- [ ] Badge/rationale logic (AC: 2)
  - [ ] Determine threshold rules for badges (e.g., CI > 0.7 => competition warning) (AC: 2)
  - [ ] Compose rationale sentences using localized templates (AC: 2,4)
  - [ ] Populate detail pane sections with bilingual headings and chip metadata (AC: 8)
- [ ] Testing (AC: 6)
  - [ ] Unit tests for sorting, badge logic, empty states (AC: 6)
  - [ ] UI automation verifying selection sync and localization (AC: 3-4,6)
  - [ ] Snapshot/visual test ensuring template renders with sample data (AC: 2,6)
  - [ ] Accessibility test covering keyboard traversal, automation IDs, and screen reader output (AC: 7)
  - [ ] Performance test ensuring list animation stays within frame budget (AC: 9)

## Dev Notes
- Use design guidance from `docs/front-end-spec.md` sections 6 & 7 (Main screen, component inventory) for layout/badge styling.
- Rationale generation should reuse data from ScoreCalculator to avoid redundant computations; consider helper that formats top factors for consistent messaging.
- Ensure binding updates run on main thread; weight adjustments should update list without losing selection when possible.
- Provide hooks for exports (Story 4.2) by keeping `ResultItem` rich enough (store lat/lng, factor details, POIs).
- For badges, align colors with style guide (primary, accent, warning) and include accessibility descriptions.
- Implement virtualization or recycling strategies (`CollectionView` with `ItemSizingStrategy.MeasureAllItems` caution) to maintain scrolling performance as UX expects fluid interactions.
- Capture animation easing + duration from motion guidelines (appendix of `docs/front-end-spec.md`) and expose constants for reuse.
- Ensure empty state matches illustration/copy from UX doc; include action link to open Settings for radius adjustment.

### Testing
- Tests align with `docs/architecture/13-test-strategy.md`; store dataset fixtures under `TestData/Results` for deterministic assertions.
- Manual QA: run analysis, ensure list sorts descending by score, check map synchronization, test localization toggles, verify empty radius scenario messaging.
- Conduct manual accessibility review with screen reader + keyboard to validate new requirements.
- Capture before/after animation timings to confirm compliance with motion specs (â‰¤200 ms) and absence of motion sickness triggers.

## Change Log
| Date | Version | Description | Author |
|---|---|---|---|
| 2025-10-07 | 0.1 | Initial draft | Sarah (PO) |

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results
