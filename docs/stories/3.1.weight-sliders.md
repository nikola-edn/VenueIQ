# Story 3.1: Advanced Weighting Sliders Panel

## Status
Ready for Dev

## Story
**As a** power user tuning VenueIQ analyses,
**I want** a panel of advanced weighting sliders for competition, demand, accessibility, and complements,
**so that** I can adjust how each factor influences the overall opportunity score.

## Acceptance Criteria
1. Main screen shall expose an "Advanced Weights" panel containing four sliders (Competition, Demand, Accessibility, Complements) with value ranges 0–100 representing percentage weight contributions.
2. Sliders must default to weight ratios defined in `docs/architecture/16-appendix.md` (35/25/25/-35 before normalization) and visually display current values via labels/badges.
3. Provide an "Auto-balance" control that resets sliders to defaults and ensures total weight normalization (positive factors sum to 65, competition subtracts per scoring formula).
4. Slider adjustments must update bound weight state in `MainViewModel` immediately while remaining responsive on both mobile and desktop layouts (collapsible on mobile per UX spec).
5. Disable Analyze button while any slider value is mid-drag (optional) but ensure final value commits once drag ends; include accessible descriptions for each slider explaining its effect.
6. Tests: unit tests verifying default value loading, reset behaviour, and normalization; UI automation covering slider rendering across breakpoints and accessibility attributes.
7. Sliders must reflect UX styling guidelines (`docs/front-end-spec.md#62-main-analysis-screen`): labeled value chips, tooltip helper icons, color-coded tracks, and bilingual helper text (Serbian primary, English secondary).
8. Provide automation IDs (`Weights.CompetitionSlider`, etc.), `SemanticProperties.Description`, and haptic/audio feedback hooks where supported to satisfy accessibility/motion expectations.
9. Ensure panel state transitions (expand/collapse, auto-balance animation) follow motion timings (≤200 ms, easing from UX spec) and maintain 44px touch targets.

## Tasks / Subtasks
- [ ] UI layout (AC: 1-4)
  - [ ] Build XAML panel/expander with slider controls and labels (AC: 1-2,4)
  - [ ] Implement responsive behavior using VisualStateManager (AC: 4)
  - [ ] Apply UX styling: value chips, helper icons, bilingual helper text, and touch target spacing (AC: 7,9)
- [ ] ViewModel bindings (AC: 2-4)
  - [ ] Add weight properties with backing fields using `CommunityToolkit.Mvvm` attributes (AC: 2-4)
  - [ ] Wire Auto-balance command resetting to defaults (AC: 3)
- [ ] Normalization & validation logic (AC: 3,5)
  - [ ] Ensure weights convert to decimals used by ScoreCalculator (AC: 2-3)
  - [ ] Optionally lock sum or display total percentage indicator (AC: 3)
  - [ ] Manage `IsDragging` state to control Analyze button (AC: 5)
- [ ] Accessibility & localization (AC: 4-5)
  - [ ] Provide localized labels/tooltips/semantic descriptions (AC: 4-5)
  - [ ] Ensure slider values announced via screen readers (AC: 5)
  - [ ] Assign automation IDs, haptic feedback triggers, and motion-reduced alternatives (AC: 8-9)
- [ ] Testing (AC: 6)
  - [ ] Unit tests for default/auto-balance logic (AC: 6)
  - [ ] UI automation verifying slider interactions and responsive states (AC: 6)
  - [ ] Accessibility test confirming semantics (AC: 6)
  - [ ] Visual regression / animation timing validation to ensure chips/tooltips render correctly (AC: 7-9)

## Dev Notes
- Follow UI spec in `docs/front-end-spec.md` sections 6 & 7 for layout, icons, and copy.
- Default weight constants reside in architecture appendix; store them in shared constants (`AppConstants`) for reuse by ScoreCalculator (Story 2.3).
- Align slider color scheme with design system (primary track, accent thumb) and respect dark mode if introduced later.
- Manage slider events to avoid redundant recomputation; actual score updates handled in Story 3.2.
- Document slider keys for persistence (Story 1.3) so the same properties integrate seamlessly.
- Reference motion & feedback appendix to replicate micro-interactions (value chip bounce, success toast on auto-balance) while honoring "Reduce Motion" OS setting.
- Provide guidance for optional haptic feedback (mobile) and audible confirmation (desktop screen reader) when auto-balance completes.
- Ensure documentation lists helper icon tooltips and links to knowledge base so copywriters can finalize localized text.

### Testing
- Tests align with `docs/architecture/13-test-strategy.md`; include UI automation scenario toggling between narrow/wide layouts.
- Manual QA: confirm sliders display defaults, auto-balance resets, values stay consistent after app restart (dependent on Story 1.3).
- Manual UX check: validate color contrast (WCAG AA), motion timing, helper tooltip copy, and haptic/audio cues operate or respectfully degrade when unsupported.

## Change Log
| Date | Version | Description | Author |
|---|---|---|---|
| 2025-10-07 | 0.1 | Initial draft | Sarah (PO) |

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results
